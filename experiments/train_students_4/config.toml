# This example trains a single expert and generates poisoned labels
# for the sinusoidal (1xs) trigger with ResNet-32s. The labels are 
# FLIPped at the provided budgets. The config file is broken down 
# into three modules detailed in the schemas/ folder.

# Module to train and record an expert trajectory.
[generate_labels]
input_pths = "out/checkpoints/tiny_imagenet_100_r18_1xs/{}/model_{}_{}.pth"
opt_pths = "out/checkpoints/tiny_imagenet_100_r18_1xs/{}/model_{}_{}_opt.pth"
expert_model = "r18-tin"
trainer = "sgd"
dataset = "tiny_imagenet"
source_label = 9
target_label = 4
poisoner = "1xs"
output_dir = "out/student_models/tiny_imagenet/4/"
lambda = 0.0

[generate_labels.expert_config]
experts = 2
min = 0
max = 20
trajectories = [50, 100, 150, 200, 250, 300, 350, 400]

[generate_labels.attack_config]
iterations = 5
one_hot_temp = 5
alpha = 0
label_kwargs = {lr = 150, momentum = 0.5}